<div class="max-w-7xl mx-auto">

  <!-- HEADER & BUTTON -->
  <div class="flex justify-between items-center mb-6">
    <h2 class="text-2xl font-semibold">Stok Bahan Ajar</h2>

    <button class="btn btn-secondary text-white" @click="openCreateForm">
      + Tambah Stok Baru
    </button>
  </div>

  <!-- FILTER CARD -->
  <div class="bg-white shadow-sm rounded-xl p-5 mb-6 border">

    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">

      <!-- UPBJJ -->
      <div class="col-span-2">
        <select class="select select-bordered w-full" v-model="filterUpbjj">
          <option value="">Semua UPBJJ</option>
          <option v-for="u in data.upbjjList" :key="u">{{ u }}</option>
        </select>
      </div>

      <!-- Qty < Safety -->
      <label class="flex items-center gap-2">
        <input type="checkbox" class="checkbox" v-model="filterMenipis">
        <span>Qty < Safety</span>
      </label>

      <!-- Qty = 0 -->
      <label class="flex items-center gap-2">
        <input type="checkbox" class="checkbox" v-model="filterKosong">
        <span>Qty = 0</span>
      </label>

    </div>

    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mt-4">

      <!-- Sort -->
      <select class="select select-bordered w-full" v-model="sortBy">
        <option disabled value="">Urutkan berdasarkan</option>
        <option value="judul">Judul</option>
        <option value="qty">Jumlah Stok</option>
        <option value="harga">Harga</option>
      </select>

      <!-- Reset -->
      <button class="btn btn-outline w-full md:w-auto" @click="resetFilter">
        Reset
      </button>

    </div>

  </div>

  <!-- TABLE CARD -->
  <div class="bg-white shadow rounded-xl p-4 border">

    <div class="overflow-x-auto">
      <table class="table table-sm">
        <thead class="bg-base-200">
          <tr>
            <th>Kode</th>
            <th>Judul</th>
            <th>Kategori</th>
            <th>UPBJJ</th>
            <th>Rak</th>
            <th>Harga</th>
            <th>Qty</th>
            <th>Safety</th>
            <th>Status</th>
            <th>Aksi</th>
          </tr>
        </thead>

        <tbody>
          <tr v-for="item in filteredAndSorted" :key="item.kode">
            <td>{{ item.kode }}</td>
            <td>{{ item.judul }}</td>
            <td>{{ item.kategori }}</td>
            <td>{{ item.upbjj }}</td>
            <td>{{ item.lokasiRak }}</td>
            <td>Rp{{ item.harga.toLocaleString("id-ID") }}</td>
            <td>{{ item.qty }}</td>
            <td>{{ item.safety }}</td>

            <td>
              <ba-stock-status :qty="item.qty" :safety="item.safety"></ba-stock-status>
              <ba-stock-tooltip :html="item.catatanHTML"></ba-stock-tooltip>
            </td>

            <td class="flex gap-1">
              <button class="btn btn-xs btn-warning" @click="openEditForm(item)">Edit</button>
              <button class="btn btn-xs btn-error" @click="confirmDelete(item)">Hapus</button>
            </td>
          </tr>
        </tbody>

      </table>
    </div>

  </div>

  <!-- FORM MODAL -->
  <ba-stock-form
    v-if="showForm"
    :editData="editData"
    @save="saveData"
    @close="closeForm">
  </ba-stock-form>

</div>
